nmds_wuni <- ordinate(physeq2, method="NMDS", distance=wuni_dist)
nmds_uni <- ordinate(physeq2, method="NMDS", distance=uni_dist)
# Visualize
plot_ordination(physeq2, nmds_wuni, color="Day", shape="Soil") +
geom_point(size=2) +
labs(title="Weighted unifrac") +
theme_test()
plot_ordination(physeq2, nmds_uni, color="Day", shape="Soil") +
geom_point(size=2) +
labs(title="Unweighted unifrac") +
theme_test()
adonis(wuni_dist~Soil+Day+Soil*Day, data=data.frame(sample_data(physeq2)), permutations=999)
# Growth
# Average number of estimates
growth_death %>%
filter(type=="growth") %>%
group_by(Soil, Replicate) %>%
summarize(ests=n()) %>%
ungroup() %>%
group_by(Soil) %>%
summarize(ests_mean = mean(ests),
ests_sd = sd(ests))
# Average generation time
growth_death %>%
filter(type=="growth") %>%
group_by(Soil, Replicate) %>%
summarize(g = mean(g)) %>%
ungroup() %>%
group_by(Soil) %>%
summarise(g_mean = mean(g),
g_sd = sd(g))
# Lag time
growth_death %>%
filter(type=="growth") %>%
group_by(Soil, Replicate) %>%
summarize(lag = mean(start_day)) %>%
ungroup() %>%
group_by(Soil) %>%
summarise(lag_mean = mean(lag),
lag_sd = sd(lag))
# change in abundance
growth_death %>%
filter(type=="growth") %>%
group_by(Soil, Replicate) %>%
summarize(chabund = mean(change_abund_corr, na.rm=TRUE)) %>%
ungroup() %>%
group_by(Soil) %>%
summarise(chabund_mean = mean(chabund),
chabund_sd = sd(chabund))
# Death
# Average number of estimates
growth_death %>%
filter(type=="death") %>%
group_by(Soil, Replicate) %>%
summarize(ests=n()) %>%
ungroup() %>%
group_by(Soil) %>%
summarize(ests_mean = mean(ests),
ests_sd = sd(ests))
# Average generation time
growth_death %>%
filter(type=="death") %>%
group_by(Soil, Replicate) %>%
summarize(g = mean(g)) %>%
ungroup() %>%
group_by(Soil) %>%
summarise(g_mean = mean(g),
g_sd = sd(g))
# Lag time
growth_death %>%
filter(type=="death") %>%
group_by(Soil, Replicate) %>%
summarize(lag = mean(start_day)) %>%
ungroup() %>%
group_by(Soil) %>%
summarise(lag_mean = mean(lag),
lag_sd = sd(lag))
# change in abundance
growth_death %>%
filter(type=="death") %>%
group_by(Soil, Replicate) %>%
summarize(chabund = mean(change_abund_corr, na.rm=TRUE)) %>%
ungroup() %>%
group_by(Soil) %>%
summarise(chabund_mean = mean(chabund),
chabund_sd = sd(chabund))
# Average across ASVs per replicate
growth_death_com <- growth_death %>%
group_by(Soil, Replicate, type) %>%
summarize(k = mean(k),
g = mean(g),
start_day = mean(start_day, na.rm=TRUE),
end_day = mean(end_day, na.rm=TRUE),
start_abund_corr = mean(start_abund_corr, na.rm=TRUE),
end_abund_corr = mean(end_abund_corr, na.rm=TRUE),
change_abund_corr = mean(change_abund_corr, na.rm=TRUE),
n16S = mean(n16S, na.rm=TRUE),
genome_size = mean(genome_size, na.rm=TRUE),
npaths_actual = mean(npaths_actual, na.rm=TRUE),
nec_actual = mean(nec_actual, na.rm=TRUE)) %>%
ungroup()
# Visualize
growth_death_com %>%
pivot_longer(cols = -c(Soil, Replicate, type), names_to = "variable", values_to = "value") %>%
ggplot(aes(x=type, y=abs(value), color=Soil)) +
geom_jitter(width=0.1) +
facet_wrap(~variable, scales="free") +
theme_test()
growth_death_com %>%
pivot_longer(cols = -c(Soil, Replicate, type), names_to = "variable", values_to = "value") %>%
ggplot(aes(x=type, y=log(abs(value)), color=Soil)) +
geom_jitter(width=0.1) +
facet_wrap(~variable, scales="free") +
theme_test()
# Figure
palette_bw2 <- c("black", "white")
growth_death_com %>%
select(Soil, Replicate, type, g, start_day, start_abund=start_abund_corr, end_abund=end_abund_corr, change_abund=change_abund_corr, n16S) %>%
pivot_longer(cols = -c(Soil, Replicate, type), names_to = "variable", values_to = "value") %>%
mutate(variable = factor(variable, levels=c("start_day", "g", "n16S", "start_abund", "end_abund", "change_abund"))) %>%
ggplot(aes(x=type, y=abs(value), shape=Soil)) +
geom_jitter(width=0.1, size=2) +
facet_wrap(~variable, scales="free") +
#scale_color_manual(values=palette_bw2) +
scale_shape_manual(values=c(1,16)) +
theme_test() +
theme(axis.title.x = element_blank(),
axis.text = element_text(size=10, color="black"),
axis.title = element_text(size=12),
legend.text = element_text(size=10),
legend.title = element_text(size=10),
panel.border = element_rect(color="black"),
strip.text = element_text(size = 10),
strip.background = element_blank())
# generation time
g_gr_lm <- lm(log(g) ~ Soil, data=growth_death_com[growth_death_com$type=="growth",])
hist(resid(g_gr_lm)) # ????
plot(predict(g_gr_lm), resid(g_gr_lm)) # homoskedastic
anova(g_gr_lm)
# start day
lag_gr_lm <- lm(start_day ~ Soil, data=growth_death_com[growth_death_com$type=="growth",])
hist(resid(lag_gr_lm)) # non-normal
plot(predict(lag_gr_lm), resid(g_gr_lm)) # homoskedastic
# Use non-parametric
lag_gr_welch <- t.test(start_day ~ Soil, data=growth_death_com[growth_death_com$type=="growth",], var.equal=FALSE)
# n16S
n16S_gr_lm <- lm(n16S ~ Soil, data=growth_death_com[growth_death_com$type=="growth",])
hist(resid(n16S_gr_lm)) # ????
plot(predict(n16S_gr_lm), resid(g_gr_lm)) # homoskedastic
anova(n16S_gr_lm)
# Change abund
chabund_gr_lm <- lm(change_abund_corr ~ Soil,
data=growth_death_com[growth_death_com$type=="growth",])
hist(resid(chabund_gr_lm))
plot(predict(chabund_gr_lm), resid(chabund_gr_lm))
summary(chabund_gr_lm)
# Start abund
startabund_gr_lm <- lm(log(start_abund_corr) ~ Soil,
data=growth_death_com[growth_death_com$type=="growth",])
hist(resid(startabund_gr_lm))
plot(predict(startabund_gr_lm), resid(startabund_gr_lm))
summary(startabund_gr_lm)
# End abund
endabund_gr_lm <- lm(log(end_abund_corr) ~ Soil,
data=growth_death_com[growth_death_com$type=="growth",])
hist(resid(endabund_gr_lm))
plot(predict(endabund_gr_lm), resid(endabund_gr_lm))
summary(endabund_gr_lm)
# Multiple test correction
growth_com_padj <- p.adjust(c(summary(g_gr_lm)$coefficients[2,4], lag_gr_welch$p.value,
summary(n16S_gr_lm)$coefficients[2,4], summary(chabund_gr_lm)$coefficients[2,4],
summary(startabund_gr_lm)$coefficients[2,4], summary(endabund_gr_lm)$coefficients[2,4]),
method = "holm", n=6)
growth_com_padj
# generation time
g_de_lm <- lm(log(g) ~ Soil, data=growth_death_com[growth_death_com$type=="death",])
hist(resid(g_de_lm)) # ????
plot(predict(g_de_lm), resid(g_de_lm)) # homoskedastic
anova(g_de_lm)
# start day
lag_de_lm <- lm(start_day ~ Soil, data=growth_death_com[growth_death_com$type=="death",])
hist(resid(lag_de_lm)) # ????
plot(predict(lag_de_lm), resid(g_de_lm)) # homoskedastic
anova(lag_de_lm)
# n16S
n16S_de_lm <- lm(log(n16S) ~ Soil, data=growth_death_com[growth_death_com$type=="death",])
hist(resid(n16S_de_lm)) # non-normal
plot(predict(n16S_de_lm), resid(n16S_de_lm)) # heteroskedastic
# Use welch t.test to deal with heteroskedasticity
n16S_de_kw <- t.test(n16S ~ Soil, data=growth_death_com[growth_death_com$type=="death",], var.equal=FALSE)
# Change abund
chabund_de_lm <- lm(log(abs(change_abund_corr)) ~ Soil,
data=growth_death_com[growth_death_com$type=="death",])
hist(resid(chabund_de_lm)) # non-normal even with log transform
plot(predict(chabund_de_lm), resid(chabund_de_lm)) # homoskedastic
# Use non-parametric test
chabund_de_kw <- kruskal.test(change_abund_corr ~ Soil, data=growth_death_com[growth_death_com$type=="death",])
# Start abund
startabund_de_lm <- lm(log(start_abund_corr) ~ Soil,
data=growth_death_com[growth_death_com$type=="death",])
hist(resid(startabund_de_lm)) # non-normal
plot(predict(startabund_de_lm), resid(startabund_de_lm)) # homoskedastic
# Use non-parametric test
startabund_de_kw <- kruskal.test(start_abund_corr ~ Soil, data=growth_death_com[growth_death_com$type=="death",])
# End abund
endabund_de_lm <- lm(log(end_abund_corr) ~ Soil,
data=growth_death_com[growth_death_com$type=="death",])
hist(resid(endabund_de_lm)) # normal
plot(predict(endabund_de_lm), resid(endabund_de_lm)) # heteroskedastic
# Use welch t-test
endabund_de_welch <- t.test(end_abund_corr ~ Soil, data=growth_death_com[growth_death_com$type=="death",], equal.var=FALSE)
# Multiple test correction
death_com_padj <- p.adjust(c(summary(g_de_lm)$coefficients[2,4], summary(lag_de_lm)$coefficients[2,4],
n16S_de_kw$p.value, chabund_de_kw$p.value, startabund_de_kw$p.value, endabund_de_welch$p.value),
method = "holm", n=6)
death_com_padj
# Average across replicates per ASV
growth_death_asv <- growth_death %>%
group_by(Soil, ASV, type) %>%
summarize(k = mean(k),
g = mean(g),
start_day = mean(start_day, na.rm=TRUE),
end_day = mean(end_day, na.rm=TRUE),
start_abund_corr = mean(start_abund_corr, na.rm=TRUE),
end_abund_corr = mean(end_abund_corr, na.rm=TRUE),
change_abund_corr = mean(change_abund_corr, na.rm=TRUE),
n16S = mean(n16S, na.rm=TRUE),
genome_size = mean(genome_size, na.rm=TRUE),
npaths_actual = mean(npaths_actual, na.rm=TRUE),
nec_actual = mean(nec_actual, na.rm=TRUE)) %>%
ungroup()
# Visualize
# Growth traits
growth_death_asv %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
ggplot(aes(x=type, y=abs(value), color=Soil)) +
geom_boxplot() +
facet_wrap(~variable, scales="free") +
theme_test()
growth_death_asv %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
ggplot(aes(x=type, y=log(abs(value)), color=Soil)) +
geom_boxplot() +
facet_wrap(~variable, scales="free") +
labs(title="Growth - log") +
theme_test()
# Death traits
growth_death_asv %>%
filter(type=="death") %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
ggplot(aes(x=type, y=abs(value), color=Soil)) +
geom_boxplot() +
facet_wrap(~variable, scales="free") +
labs(title="Growth") +
theme_test()
growth_death_asv %>%
filter(type=="death") %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
ggplot(aes(x=type, y=log(abs(value)), color=Soil)) +
geom_boxplot() +
facet_wrap(~variable, scales="free") +
labs(title="Growth - log") +
theme_test()
# Growth trait density
growth_death_asv %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
filter(type=="growth") %>%
ggplot(aes(abs(value), color=Soil)) +
geom_density() +
facet_wrap(~variable, scales="free") +
labs(title="Growth") +
theme_test()
growth_death_asv %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
filter(type=="growth") %>%
ggplot(aes(log(abs(value)), color=Soil)) +
geom_density() +
facet_wrap(~variable, scales="free") +
labs(title="Growth - log") +
theme_test()
# Death trait density
growth_death_asv %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
filter(type=="death") %>%
ggplot(aes(abs(value), color=Soil)) +
geom_density() +
facet_wrap(~variable, scales="free") +
labs(title="Death") +
theme_test()
growth_death_asv %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
filter(type=="death") %>%
ggplot(aes(log(abs(value)), color=Soil)) +
geom_density() +
facet_wrap(~variable, scales="free") +
labs(title="Death - log") +
theme_test()
# Growth
palette_bw2 <- c("darkgrey", "black")
growth_death_asv %>%
filter(type=="growth") %>%
select(Soil:type, g, start_day, start_abund=start_abund_corr, end_abund=end_abund_corr, change_abund=change_abund_corr, n16S) %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
mutate(variable = factor(variable, levels=c("start_day", "g", "n16S", "start_abund", "end_abund", "change_abund"))) %>%
ggplot(aes(log(abs(value)), color=Soil)) +
geom_density() +
facet_wrap(~variable, scales="free") +
scale_color_manual(values=palette_bw2) +
labs(title="Growth") +
theme_test() +
theme(axis.text = element_text(size=10, color="black"),
axis.title = element_text(size=12),
legend.text = element_text(size=10),
legend.title = element_text(size=10),
panel.border = element_rect(color="black"),
strip.text = element_text(size = 10),
strip.background = element_blank())
# Death
palette_bw2 <- c("darkgrey", "black")
growth_death_asv %>%
filter(type=="death") %>%
select(Soil:type, g, start_day, start_abund=start_abund_corr, end_abund=end_abund_corr, change_abund=change_abund_corr, n16S) %>%
pivot_longer(cols = -c(Soil, ASV, type), names_to = "variable", values_to = "value") %>%
mutate(variable = factor(variable, levels=c("start_day", "g", "n16S", "start_abund", "end_abund", "change_abund"))) %>%
ggplot(aes(log(abs(value)), color=Soil)) +
geom_density() +
facet_wrap(~variable, scales="free") +
scale_color_manual(values=palette_bw2) +
labs(title="Death") +
theme_test() +
theme(axis.text = element_text(size=10, color="black"),
axis.title = element_text(size=12),
legend.text = element_text(size=10),
legend.title = element_text(size=10),
panel.border = element_rect(color="black"),
strip.text = element_text(size = 10),
strip.background = element_blank())
# generation time
g_gr_lm <- lm(log(g) ~ Soil, data=growth_death_asv[growth_death_asv$type=="growth",])
hist(resid(g_gr_lm)) # normal
plot(predict(g_gr_lm), resid(g_gr_lm)) # homoskedastic
summary(g_gr_lm)
# start day
lag_gr_lm <- lm(start_day ~ Soil, data=growth_death_asv[growth_death_asv$type=="growth",])
hist(resid(lag_gr_lm)) # non-normal
plot(predict(lag_gr_lm), resid(g_gr_lm)) # homoskedastic
# Use non-parametric test
lag_gr_kw <- kruskal.test(start_day ~ Soil, data=growth_death_asv[growth_death_asv$type=="growth",])
# n16S
n16S_gr_lm <- lm(n16S ~ Soil, data=growth_death_asv[growth_death_asv$type=="growth",])
hist(resid(n16S_gr_lm)) # non-normal
plot(predict(n16S_gr_lm), resid(g_gr_lm)) # homoskedastic
# Use non-parametric test
n16S_gr_kw <- kruskal.test(n16S ~ Soil, data=growth_death_asv[growth_death_asv$type=="growth",])
# Change abund
chabund_gr_lm <- lm(log(change_abund_corr) ~ Soil,
data=growth_death_asv[growth_death_asv$type=="growth",])
hist(resid(chabund_gr_lm)) # normal
plot(predict(chabund_gr_lm), resid(chabund_gr_lm)) # homoskedastic w/ or w/o log transform
summary(chabund_gr_lm)
# Start abund
startabund_gr_lm <- lm(log(start_abund_corr) ~ Soil,
data=growth_death_asv[growth_death_asv$type=="growth",])
hist(resid(startabund_gr_lm)) # normal
plot(predict(startabund_gr_lm), resid(startabund_gr_lm)) # homoskedastic
summary(startabund_gr_lm)
# End abund
endabund_gr_lm <- lm(log(end_abund_corr) ~ Soil,
data=growth_death_asv[growth_death_asv$type=="growth",])
hist(resid(endabund_gr_lm)) # normal
plot(predict(endabund_gr_lm), resid(endabund_gr_lm)) # homoskedastic
summary(endabund_gr_lm)
# Multiple test correction
growth_asv_padj <- p.adjust(c(summary(g_gr_lm)$coefficients[2,4], lag_gr_kw$p.value, n16S_gr_kw$p.value,
summary(chabund_gr_lm)$coefficients[2,4],
summary(startabund_gr_lm)$coefficients[2,4], summary(endabund_gr_lm)$coefficients[2,4]),
method = "holm", n=6)
growth_asv_padj
# generation time
g_de_lm <- lm(log(g) ~ Soil, data=growth_death_asv[growth_death_asv$type=="death",])
hist(resid(g_de_lm)) # normal
plot(predict(g_de_lm), resid(g_de_lm)) # homoskedastic
summary(g_de_lm)
# start day
lag_de_lm <- lm(start_day ~ Soil, data=growth_death_asv[growth_death_asv$type=="death",])
hist(resid(lag_de_lm)) # non-normal
plot(predict(lag_de_lm), resid(g_de_lm)) # homoskedastic
# Use non-parametric test
lag_de_kw <- kruskal.test(start_day ~ Soil, data=growth_death_asv[growth_death_asv$type=="death",])
# n16S
n16S_de_lm <- lm(n16S ~ Soil, data=growth_death_asv[growth_death_asv$type=="death",])
hist(resid(n16S_de_lm)) # non-normal even w/log transform
plot(predict(n16S_de_lm), resid(g_de_lm)) # homoskedastic
# Use non-parametric test
n16S_de_kw <- kruskal.test(n16S ~ Soil, data=growth_death_asv[growth_death_asv$type=="death",])
# Change abund
chabund_de_lm <- lm(log(abs(change_abund_corr)) ~ Soil,
data=growth_death_asv[growth_death_asv$type=="death",])
hist(resid(chabund_de_lm)) # normal
plot(predict(chabund_de_lm), resid(chabund_de_lm)) # homoskedastic w/ or w/o log transform
summary(chabund_de_lm)
# Start abund
startabund_de_lm <- lm(log(start_abund_corr) ~ Soil,
data=growth_death_asv[growth_death_asv$type=="death",])
hist(resid(startabund_de_lm)) # normal
plot(predict(startabund_de_lm), resid(startabund_de_lm)) # homoskedastic
summary(startabund_de_lm)
# End abund
endabund_de_lm <- lm(log(end_abund_corr) ~ Soil,
data=growth_death_asv[growth_death_asv$type=="death",])
hist(resid(endabund_de_lm)) # normal
plot(predict(endabund_de_lm), resid(endabund_de_lm)) # homoskedastic
summary(endabund_de_lm)
# Multiple test correction
death_asv_padj <- p.adjust(c(summary(g_de_lm)$coefficients[2,4], lag_de_kw$p.value, n16S_de_kw$p.value,
summary(chabund_de_lm)$coefficients[2,4],
summary(startabund_de_lm)$coefficients[2,4], summary(endabund_de_lm)$coefficients[2,4]),
method = "holm", n=6)
death_asv_padj
growth_death_asv %>%
select(Soil, ASV, type, change_abund_corr) %>%
pivot_wider(names_from=type, values_from=change_abund_corr) %>%
filter(!(is.na(death) | is.na(growth))) %>% # only taxa with a growth and death estimate
ggplot(aes(x=log(growth), y=log(abs(death)))) +
geom_point() +
geom_smooth(method="lm", linetype=2, color="black") +
labs(x="ln deltaNg", y="ln deltaNd") +
#scale_shape_manual(values=c(1, 19)) +
facet_wrap(~Soil, scales="free") +
theme_test() +
theme()
growth_death_asv %>%
select(Soil, ASV, type, change_abund_corr) %>%
pivot_wider(names_from=type, values_from=change_abund_corr) %>%
filter(!(is.na(death) | is.na(growth))) %>% # only taxa with a growth and death estimate
ggplot(aes(x=log(growth), y=log(abs(death)))) +
geom_point() +
geom_smooth(method="lm", linetype=2, color="black") +
labs(x="ln deltaNg", y="ln deltaNd") +
#scale_shape_manual(values=c(1, 19)) +
facet_wrap(~Soil) +
theme_test() +
theme()
growth_death_asv %>%
select(Soil, ASV, type, change_abund_corr) %>%
pivot_wider(names_from=type, values_from=change_abund_corr) %>%
filter(!(is.na(death) | is.na(growth))) %>% # only taxa with a growth and death estimate
ggplot(aes(x=log(growth), y=log(abs(death)), shape=Soil)) +
geom_point() +
geom_smooth(method="lm", linetype=2, color="black") +
labs(x="ln deltaNg", y="ln deltaNd") +
scale_shape_manual(values=c(1,16)) +
#scale_shape_manual(values=c(1, 19)) +
#facet_wrap(~Soil) +
theme_test() +
theme()
growth_death_asv %>%
select(Soil, ASV, type, change_abund_corr) %>%
pivot_wider(names_from=type, values_from=change_abund_corr) %>%
filter(!(is.na(death) | is.na(growth))) %>% # only taxa with a growth and death estimate
ggplot(aes(x=log(growth), y=log(abs(death)), shape=Soil)) +
geom_point() +
geom_smooth(method="lm", linetype=2, color="black") +
labs(x="ln deltaNg", y="ln deltaNd") +
scale_shape_manual(values=c(1,16)) +
geom_abline(slope=1, intercept=0) +
#scale_shape_manual(values=c(1, 19)) +
#facet_wrap(~Soil) +
theme_test() +
theme()
growth_death_asv %>%
select(Soil, ASV, type, change_abund_corr) %>%
pivot_wider(names_from=type, values_from=change_abund_corr) %>%
filter(!(is.na(death) | is.na(growth))) %>% # only taxa with a growth and death estimate
ggplot(aes(x=log(growth), y=log(abs(death))) +
geom_point(aes(shape=Soil))) +
geom_smooth(method="lm", linetype=2, color="black") +
labs(x="ln deltaNg", y="ln deltaNd") +
scale_shape_manual(values=c(1,16)) +
geom_abline(slope=1, intercept=0) +
#scale_shape_manual(values=c(1, 19)) +
#facet_wrap(~Soil) +
theme_test() +
theme()
growth_death_asv %>%
select(Soil, ASV, type, change_abund_corr) %>%
pivot_wider(names_from=type, values_from=change_abund_corr) %>%
filter(!(is.na(death) | is.na(growth))) %>% # only taxa with a growth and death estimate
ggplot(aes(x=log(growth), y=log(abs(death))) +
geom_point(aes(shape=Soil))) +
geom_smooth(method="lm", linetype=2, color="black") +
labs(x="ln deltaNg", y="ln deltaNd") +
scale_shape_manual(values=c(1,16)) +
geom_abline(slope=1, intercept=0) +
#scale_shape_manual(values=c(1, 19)) +
#facet_wrap(~Soil) +
theme_test() +
theme()
growth_death_asv %>%
select(Soil, ASV, type, change_abund_corr) %>%
pivot_wider(names_from=type, values_from=change_abund_corr) %>%
filter(!(is.na(death) | is.na(growth))) %>% # only taxa with a growth and death estimate
ggplot(aes(x=log(growth), y=log(abs(death)))) +
geom_point(aes(shape=Soil)) +
geom_smooth(method="lm", linetype=2, color="black") +
labs(x="ln deltaNg", y="ln deltaNd") +
scale_shape_manual(values=c(1,16)) +
geom_abline(slope=1, intercept=0) +
#scale_shape_manual(values=c(1, 19)) +
#facet_wrap(~Soil) +
theme_test() +
theme()
